<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tugas Besar GrafKom</title>
    <script src="lib.js"></script> 
    <style>
        canvas {
            border: 2px solid black;
            cursor: crosshair;
            background-color: #c2ddf6b4;
        }
        #controls {
            margin-top: 10px;
        }
        body {
            background-color: #98FF98;
        }
    </style>
</head>
<body>
    <h1>Visualisasi Stack</h1>
    <div id="visualization-container" style="position: relative; width: 1000px; height: 400px;">
        <canvas id="canvas1" height="400" width="1000"></canvas>
    </div>
    
    <div id="controls">
        <label for="inputN">Masukkan Jumlah Lingkaran (N, max 10):</label>
        <input type="number" id="inputN" value="5" min="1" max="10">
        <button onclick="prosesInput()">Gambar Lingkaran</button> </br>
        <button onclick="sortStack()">Sort (Ascending)</button>
        <button onclick="sortDescending()">Sort (Descending)</button>
        <p id="outputN"></p>
    </div>
    
    <script>
    var canvasKita = document.querySelector("#canvas1");
    var ctx = canvasKita.getContext("2d");

    const YC = 200;
    const RADIUS = 30;
    const BLACK = {r:0, g:0, b:0};
    const RED = {r:255, g:0, b:0};
    const SPACING = 100;
    const MAX_N = 10;
    const START_XC = 50; 

    let a = []; 

    function prosesInput() {
        const inputElement = document.getElementById('inputN');
        
        let N = parseInt(inputElement.value); 
        
        N = Math.min(MAX_N, N); 
        if (isNaN(N) || N < 1) {
            N = 1; 
        }
        inputElement.value = N; 

        document.getElementById('outputN').innerText = "Menggambar " + N + " stack dengan nilai acak (1-99).";

        ctx.clearRect(0, 0, canvasKita.width, canvasKita.height);
        let imageDataSaya = ctx.getImageData(0, 0, canvasKita.width, canvasKita.height);

        a = Array.from({ length: MAX_N }, () => {
            return Math.floor(Math.random() * 98) + 1; 
        });

        console.log(a);
        
        for (let i = 0; i < N; i++) {
            let new_xc = START_XC + (i * SPACING); 
            
            lingkaran_polar(imageDataSaya, new_xc, YC, RADIUS, BLACK);

            if (i < N - 1) {
                let arrow_start_x = new_xc + RADIUS - 30;
                arrow(imageDataSaya, arrow_start_x, YC, RED); 
            }
            
            if (ctx.fillText) { 
                ctx.putImageData(imageDataSaya, 0, 0); 
                
                ctx.font = '20px Arial'; 
                ctx.fillStyle = 'blue';
                ctx.textAlign = 'center';
                
                ctx.fillText(a[i].toString(), new_xc, YC + 7); 
                
                imageDataSaya = ctx.getImageData(0, 0, canvasKita.width, canvasKita.height);
            }
        }
        
        ctx.putImageData(imageDataSaya, 0, 0);
    }

    function sortStack() {
        const inputElement = document.getElementById('inputN');
        
        let N = parseInt(inputElement.value); 
        
        N = Math.min(MAX_N, N); 
        if (isNaN(N) || N < 1) {
            N = 1; 
        }
        inputElement.value = N; 
        
        if (a.length === 0) {
            alert("Tekan tombol 'Gambar Lingkaran' terlebih dahulu untuk membuat data.");
            return;
        }

        let elementsToSort = a.slice(0, N);
        
        elementsToSort.sort((val1, val2) => val1 - val2); 

        for (let i = 0; i < N; i++) {
            a[i] = elementsToSort[i];
        }

        document.getElementById('outputN').innerText = "Stack telah diurutkan (Ascending): " + a.slice(0, N).join(', ');

        ctx.clearRect(0, 0, canvasKita.width, canvasKita.height);
        let imageDataSaya = ctx.getImageData(0, 0, canvasKita.width, canvasKita.height);

        for (let i = 0; i < N; i++) {
            let new_xc = START_XC + (i * SPACING); 
            
            lingkaran_polar(imageDataSaya, new_xc, YC, RADIUS, BLACK);

            if (i < N - 1) {
                let arrow_start_x = new_xc + RADIUS - 30;
                arrow(imageDataSaya, arrow_start_x, YC, RED);
            }
            
            if (ctx.fillText) { 
                ctx.putImageData(imageDataSaya, 0, 0); 
                
                ctx.font = '20px Arial'; 
                ctx.fillStyle = 'blue';
                ctx.textAlign = 'center';
                
                ctx.fillText(a[i].toString(), new_xc, YC + 7); 
                
                imageDataSaya = ctx.getImageData(0, 0, canvasKita.width, canvasKita.height);
            }
        }
        
        ctx.putImageData(imageDataSaya, 0, 0);
    }

    function sortDescending(){
        const inputElement = document.getElementById('inputN');
        
        let N = parseInt(inputElement.value); 
        
        N = Math.min(MAX_N, N); 
        if (isNaN(N) || N < 1) {
            N = 1; 
        }
        inputElement.value = N; 
        
        if (a.length === 0) {
            alert("Tekan tombol 'Gambar Lingkaran' terlebih dahulu untuk membuat data.");
            return;
        }

        let elementsToSort = a.slice(0, N);
        
        elementsToSort.sort((val1, val2) => val2 - val1); 

        for (let i = 0; i < N; i++) {
            a[i] = elementsToSort[i];
        }

        document.getElementById('outputN').innerText = "Stack telah diurutkan (Descending): " + a.slice(0, N).join(', ');

        ctx.clearRect(0, 0, canvasKita.width, canvasKita.height);
        let imageDataSaya = ctx.getImageData(0, 0, canvasKita.width, canvasKita.height);

        for (let i = 0; i < N; i++) {
            let new_xc = START_XC + (i * SPACING); 
            
            lingkaran_polar(imageDataSaya, new_xc, YC, RADIUS, BLACK);

            if (i < N - 1) {
                let arrow_start_x = new_xc + RADIUS - 30;
                arrow(imageDataSaya, arrow_start_x, YC, RED);
            }
            
            if (ctx.fillText) { 
                ctx.putImageData(imageDataSaya, 0, 0); 
                
                ctx.font = '20px Arial'; 
                ctx.fillStyle = 'blue';
                ctx.textAlign = 'center';
                
                ctx.fillText(a[i].toString(), new_xc, YC + 7); 
                
                imageDataSaya = ctx.getImageData(0, 0, canvasKita.width, canvasKita.height);
            }
        }
        
        ctx.putImageData(imageDataSaya, 0, 0);
    }

    window.onload = prosesInput;
    </script>
</body>
</html>
